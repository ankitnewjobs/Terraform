{
  "appId": "ca208598-cae9-4b70-9ce6-a306e5e94d4a",
  "displayName": "azure-cli-2021-07-10-05-04-55",
  "name": "ca208598-cae9-4b70-9ce6-a306e5e94d4a",
  "password": "DY7WICGyz~rOZxm3tm6cQ.5qiMu.I7GyLU",
  "tenant": "c81f465b-99f9-42d3-a169-8082d61c677a"
}


appId = ARM_CLIENT_ID
password = ARM_CLIENT_SECRET
tenant = ARM_TENANT_ID

az account list -o table
SubscriptionId = ARM_SUBSCRIPTION_ID

# Environment Variables for Terraform Cloud 

ARM_CLIENT_ID=ca208598-cae9-4b70-9ce6-a306e5e94d4a
ARM_CLIENT_SECRET=DY7WICGyz~rOZxm3tm6cQ.5qiMu.I7GyLU
ARM_TENANT_ID=c81f465b-99f9-42d3-a169-8082d61c677a
ARM_SUBSCRIPTION_ID=82808767-144c-4c66-a320-b30791668b0a



# Verify

az logout
az account list-locations -o table
az login --service-principal -u CLIENT_ID -p CLIENT_SECRET --tenant TENANT_ID
az login --service-principal -u ca208598-cae9-4b70-9ce6-a306e5e94d4a -p DY7WICGyz~rOZxm3tm6cQ.5qiMu.I7GyLU --tenant c81f465b-99f9-42d3-a169-8082d61c677a
az account list-locations -o table
az logout

----------------------------------------------------------------------------------------------------------------------------------------

# Explanation: -

# 1. The JSON block – output from Azure CLI

json
{
  "appId": "ca208598-cae9-4b70-9ce6-a306e5e94d4a",
  "displayName": "azure-cli-2021-07-10-05-04-55",
  "name": "ca208598-cae9-4b70-9ce6-a306e5e94d4a",
  "password": "DY7WICGyz~rOZxm3tm6cQ.5qiMu.I7GyLU",
  "tenant": "c81f465b-99f9-42d3-a169-8082d61c677a"
}

This is the output of: az ad sp create-for-rbac --role="Contributor" --scopes="/subscriptions/<SUBSCRIPTION_ID>"

What each field means:

* appId

  * This is the Client ID of the Service Principal.
  * Terraform and other apps use this as the “username” when doing service principal auth.

* displayName

  * A friendly name auto-generated by Azure CLI.
  * Useful for you to identify this SP later in the Azure portal or az ad sp list.

* name

  * Usually a URL-like identifier (sometimes the same as appId, depending on how it’s created).
  * Internal identifier for the service principal object.

* password

  * This is the Client Secret.
  * Think of it as the “password” for the appId.
  * Very sensitive: should be treated like a secret (never commit to Git, never share).

* tenant

  * This is the Tenant ID (GUID of your Azure AD tenant).
  * Needed so clients know which Azure AD to authenticate against.

# 2. Mapping to Terraform environment variables

appId = ARM_CLIENT_ID
password = ARM_CLIENT_SECRET
tenant = ARM_TENANT_ID

Here you are defining the mapping that Terraform’s Azure provider understands:

* ARM_CLIENT_ID → use the appId value
* ARM_CLIENT_SECRET → use the password value
* ARM_TENANT_ID → use the tenant value

Terraform’s azurerm provider supports environment-variable-based auth. When these ARM_ variables are set, the provider reads them and uses the service principal credentials to authenticate.

# 3. Getting the subscription ID

az account list -o table
SubscriptionId = ARM_SUBSCRIPTION_ID

* az account list -o table lists all subscriptions you have access to.
* You pick the subscription you want Terraform to manage and copy its ID.
* That value becomes: ARM_SUBSCRIPTION_ID = <that GUID from SubscriptionId>

So now you have all 4 key values:

* ARM_CLIENT_ID
* ARM_CLIENT_SECRET
* ARM_TENANT_ID
* ARM_SUBSCRIPTION_ID

# 4. Environment variables for Terraform Cloud

ARM_CLIENT_ID=ca208598-cae9-4b70-9ce6-a306e5e94d4a
ARM_CLIENT_SECRET=DY7WICGyz~rOZxm3tm6cQ.5qiMu.I7GyLU
ARM_TENANT_ID=c81f465b-99f9-42d3-a169-8082d61c677a
ARM_SUBSCRIPTION_ID=82808767-144c-4c66-a320-b30791668b0a

These are the actual values you will put in Terraform Cloud → Workspace → Variables → Environment Variables.

Why?

* When Terraform Cloud runs a plan/apply for a workspace using the azurerm provider:

  * It reads these ARM_ env vars.
  * It uses service principal auth with:

    * client_id = ARM_CLIENT_ID
    * client_secret = ARM_CLIENT_SECRET
    * tenant_id = ARM_TENANT_ID
    * subscription_id = ARM_SUBSCRIPTION_ID

* That’s how Terraform Cloud can talk to your Azure subscription without needing az login or your personal account.

In short: This is the bridge between Terraform Cloud and Azure.

# 5. Verification commands: - 

# Verify

az logout
az account list-locations -o table
az login --service-principal -u CLIENT_ID -p CLIENT_SECRET --tenant TENANT_ID
az login --service-principal -u ca208598-cae9-4b70-9ce6-a306e5e94d4a -p DY7WICGyz~rOZxm3tm6cQ.5qiMu.I7GyLU --tenant c81f465b-99f9-42d3-a169-8082d61c677a
az account list-locations -o table
az logout

Let’s break it:

1. az logout

   * Clears existing Azure CLI sessions.
   * Ensures you are not logged in as your user anymore (clean state).

2. az account list-locations -o table

   * If you run this right after logout, it should fail or show nothing, because you’re not logged in.
   * (This just confirms you truly logged out.)

3. az login --service-principal -u CLIENT_ID -p CLIENT_SECRET --tenant TENANT_ID

   * This logs in as the service principal instead of a user account.

   * The line with actual values:

          az login --service-principal \
       -u ca208598-cae9-4b70-9ce6-a306e5e94d4a \
       -p DY7WICGyz~rOZxm3tm6cQ.5qiMu.I7GyLU \
       --tenant c81f465b-99f9-42d3-a169-8082d61c677a
     
   * If this succeeds, it proves:

     * The client ID, secret, and tenant ID are valid.
     * The service principal has access to Azure.

4. az account list-locations -o table

   * Now that you’re logged in as the SP, this should list all Azure regions (eastus, westeurope, etc.).
   * This is a functional test that the SP can make Azure API calls.

5. az logout

   * Logs out again to clean up your CLI session.

Important point:
These verification steps are done locally just to double-check your service principal works.
Terraform Cloud will later use the same values via ARM_ env vars, but in its own environment.

# 6. How it all connects with Terraform

Putting it all together:

1. You create a service principal → get JSON output (appId, password, tenant).
2. You map those fields to Terraform Azure provider environment variables:

   * appId → ARM_CLIENT_ID
   * password → ARM_CLIENT_SECRET
   * tenant → ARM_TENANT_ID
   * Subscription ID from az account list → ARM_SUBSCRIPTION_ID

3. You configure these as environment variables in Terraform Cloud Workspace.
4. When you run terraform plan / terraform apply (CLI-driven workflow):

   * Terraform Cloud loads these env vars.
   * azurerm provider authenticates with Azure using the service principal.
   * Your infra gets created/managed in that subscription.

If you like, next I can:

* Show a mini azurerm provider block and explain how it implicitly uses these ARM_ env vars, or
* Help you turn this into an “interview-style” explanation you can give if someone asks, “How does Terraform Cloud authenticate to Azure in your setup?”
